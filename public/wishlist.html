<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wishlist - Silas Car Rentals</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ===== HEADER ===== -->
  <header class="navbar">
    <div class="container nav-inner">
      <a href="index.html" class="brand">
        <div class="brand-mark">SC</div>
        <span class="brand-name">Silas Car Rentals</span>
      </a>
      <nav class="nav-links">
        <a class="nav-link" href="index.html#browse">Browse</a>
        <a class="nav-link" href="book.html">Book</a>
        <a class="nav-link" href="index.html#how">How it Works</a>
        <a class="nav-link" href="index.html#testimonials">Testimonials</a>
        <a class="nav-link" href="index.html#contact">Contact</a>
      </nav>
      <div class="nav-actions">
        <button class="btn btn-ghost" onclick="location.href='cart.html'">
          üßæ Cart (<span id="cart-count">0</span>)
        </button>
        <button class="btn btn-ghost" onclick="location.href='wishlist.html'">
          ‚ù§Ô∏è Wishlist (<span id="wishlist-count">0</span>)
        </button>
        <button class="btn btn-ghost" onclick="location.href='saved.html'">
          üíæ Saved (<span id="saved-count">0</span>)
        </button>
      </div>
    </div>
  </header>

  <!-- ===== MAIN ===== -->
  <main class="section container">
    <h1>My Wishlist</h1>
    <div id="wishlist-items" class="grid" style="gap:20px; margin-top:20px;"></div>
  </main>

  <!-- ===== TOAST ===== -->
  <div class="toast" id="toast"></div>

  <script>
    function getStorage(key) {
      return JSON.parse(localStorage.getItem(key)) || [];
    }
    function setStorage(key, value) {
      localStorage.setItem(key, JSON.stringify(value));
    }
    function updateCounts() {
      document.getElementById("cart-count").textContent = getStorage("cart").length;
      document.getElementById("wishlist-count").textContent = getStorage("wishlist").length;
      document.getElementById("saved-count").textContent = getStorage("savedCars").length;
    }
    function showToast(msg, ms=3000) {
      const toast = document.getElementById("toast");
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(() => toast.classList.remove("show"), ms);
    }
    function renderWishlist() {
      const list = getStorage("wishlist");
      const container = document.getElementById("wishlist-items");
      if (!list.length) {
        container.innerHTML = "<p>Your wishlist is empty.</p>";
        return;
      }
      container.innerHTML = list.map(car => `
        <div class="car-card">
          <img src="${car.image || 'https://vehicle-images.dealerinspire.com/a1a7-11002896/W1KAF4GB4SR252999/00f2d6ad30e089cb5c02791d58c3af6a.jpg'}" 
               alt="${car.make}" style="width:100%; height:auto; border-radius:8px;">
          <h3>${car.make} ${car.model}</h3>
          <p><strong>‚Ç¶${car.price.toLocaleString()}</strong> / day</p>
          <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;">
            <button class="btn" onclick='checkoutCar(${JSON.stringify(car).replace(/"/g, "&quot;")})'>Book Now</button>
            <button class="btn btn-outline" onclick='addToCart(${JSON.stringify(car).replace(/"/g, "&quot;")})'>Add to Cart</button>
            <button class="btn btn-outline" onclick='removeFromWishlist("${car._id}")'>Remove</button>
          </div>
        </div>
      `).join("");
    }
    function checkoutCar(car) {
      localStorage.setItem("currentCar", JSON.stringify(car));
      window.location.href = "book.html";
    }
    function addToCart(car) {
      let cart = getStorage("cart");
      if (!cart.find(c => c._id === car._id)) {
        cart.push(car);
        setStorage("cart", cart);
        updateCounts();
        showToast("Added to cart");
      } else {
        showToast("Already in cart");
      }
    }
    function removeFromWishlist(id) {
      let list = getStorage("wishlist");
      list = list.filter(c => c._id !== id);
      setStorage("wishlist", list);
      updateCounts();
      renderWishlist();
      showToast("Removed from wishlist");
    }
    updateCounts();
    renderWishlist();
  </script>

  <style>
    .toast { position: fixed; bottom: 1.5rem; left: 50%; transform: translateX(-50%); background: #03dac5; color: #121212; padding: 0.7rem 1.2rem; border-radius: 4px; font-weight: 600; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; z-index: 9999; }
    .toast.show { opacity: 1; }
    .car-card { border: 1px solid #333; border-radius: 8px; padding: 1rem; background: #1f1f1f; color: #fff; }
    .btn { background: #03dac5; border: none; color: #121212; padding: 0.6rem 1rem; border-radius: 6px; cursor: pointer; font-weight: bold; }
    .btn-outline { background: transparent; border: 2px solid #03dac5; color: #03dac5; }
    .btn:hover { background: #00b2a9; }
    .btn-outline:hover { background: #03dac5; color: #121212; }
  </style>
</body>
</html>
